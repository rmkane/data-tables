<!html>
<html>
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8">
		<title>Bootstrap DataTable with Export</title>
		
		<script type="text/javascript" src="../public/components/jquery/dist/jquery.min.js"></script>
		<script type="text/javascript" src="../public/components/datatables/media/js/jquery.dataTables.js"></script>
		<script type="text/javascript" src="../public/components/datatables-fixedHeader/js/dataTables.fixedHeader.js"></script>
		<script type="text/javascript" src="../public/components/bootstrap/dist/js/bootstrap.min.js"></script>
		<script type="text/javascript" src="../public/components/moment/min/moment.min.js"></script>
		<script type="text/javascript" src="../public/components/jspdf/dist/jspdf.min.js"></script>

		<script type="text/javascript" src="../src/jquery.tableBuilder.js"></script>
		<script type="text/javascript" src="../src/script.js"></script>

		<script type="text/javascript">
		$(function() {
			var tableSelector = 'table#table-data';
			var columns = [{
				dataIndex : 'rank',
				text : 'Rank'
			}, {
				dataIndex : 'country',
				text : 'Country'
			}, {
				dataIndex : 'population',
				text : 'Population',
				format : function(value) {
					return value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				}
			}, {
				dataIndex : 'date',
				text : 'Date',
				align : 'right',
				format : function(value) {
					return moment(value).format('MMMM Do, YYYY')
				}
			}, {
				dataIndex : 'percentOfWorld',
				text : 'Percent of World',
				format : function(value) {
					return (value * 100).toFixed(2) + '%';
				}
			}, {
				dataIndex : 'iso2',
				text : 'ISO 3166-1',
			}, {
				dataIndex : 'iso2',
				text : 'Flag',
				allowHTML : true,
				format : function(value, record) {
					var code = value.length > 0
						? value.toLowerCase()
						: record.linked.toLowerCase();
					
					return '<span class="famfamfam-flags ' + code+ '"></span>';
				}
			}];
			
			$.getJSON("assets/data/master-countries.json", function(data) {
				$(tableSelector).tableBuilder({
					columns : columns,
					records : data
				});

				toDataTable(tableSelector);
			});
			
			$('#export-btn').click(function() {
				exportToPDF('#table-export');
			});
		});
		</script>
		<link rel="stylesheet" type="text/css" href="../public/components/font-awesome/css/font-awesome.css">
		<link rel="stylesheet" type="text/css" href="../public/components/bootstrap/dist/css/bootstrap.min.css">
		<link rel="stylesheet" type="text/css" href="../public/components/datatables/media/css/jquery.dataTables.min.css"/>
		<link rel="stylesheet" type="text/css" href="../public/components/famfamfam-flags/dist/sprite/famfamfam-flags.min.css"/>
		<link rel="stylesheet" type="text/css" href="css/style.css"/>
		<style type="text/css">
			span.famfamfam-flags {
				display: block;
				margin: 0 auto;
			}
		</style>
	</head>
	<body>
		<div class="page-wrapper">
			<h1><span class="fa fa-table"></span> Bootstrap DataTables + Export</span></h1>
			<div id="table-export">
				<table id="table-data" class="table table-striped"></table>
			</div>
			<button id="export-btn" class="btn btn-primary">
				<span class="fa fa-file-pdf-o"></span> Export to PDF
			</button>
		</div>
	</body>
</html>
